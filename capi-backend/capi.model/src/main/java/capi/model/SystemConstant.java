package capi.model;

/**
 * System Constant
 */
public class SystemConstant {
	
	// System configuration name
	/**
	 * Discount Text 1
	 */
	public static final String DISCOUNT_TEXT_01 = "DiscountText01";
	/**
	 * Discount Text 2
	 */
	public static final String DISCOUNT_TEXT_02 = "DiscountText02";
	/**
	 * Discount Text 3
	 */
	public static final String DISCOUNT_TEXT_03 = "DiscountText03";
	/**
	 * Discount Text 4
	 */
	public static final String DISCOUNT_TEXT_04 = "DiscountText04";
	/**
	 * Discount Text 5
	 */
	public static final String DISCOUNT_TEXT_05 = "DiscountText05";
	/**
	 * Discount Text 6
	 */
	public static final String DISCOUNT_TEXT_06 = "DiscountText06";
	/**
	 * Discount Text 7
	 */
	public static final String DISCOUNT_TEXT_07 = "DiscountText07";
	/**
	 * Discount Text 8
	 */
	public static final String DISCOUNT_TEXT_08 = "DiscountText08";
	/**
	 * Discount Text 9
	 */
	public static final String DISCOUNT_TEXT_09 = "DiscountText09";
	/**
	 * Discount Text 10
	 */
	public static final String DISCOUNT_TEXT_10 = "DiscountText10";
	/**
	 * Discount Text 11
	 */
	public static final String DISCOUNT_TEXT_11 = "DiscountText11";
	/**
	 * Discount Text 12
	 */
	public static final String DISCOUNT_TEXT_12 = "DiscountText12";
	
	/**
	 * Country of origin
	 */
	public static final String COUNTRY_OF_ORIGIN = "CountryOfOrigin";
		
	public static final String BUS_PARAM_SUMMER_START_DATE = "SummerStartDate";
	public static final String BUS_PARAM_SUMMER_END_DATE = "SummerEndDate";
	public static final String BUS_PARAM_WINTER_START_DATE = "WinterStartDate";
	public static final String BUS_PARAM_WINTER_END_DATE = "WinterEndDate";
	public static final String BUS_PARAM_COUNTRY_OF_ORIGINS = "CountryOfOrigin";
	public static final String BUS_PARAM_PUBLIC_HOLIDAY_URL = "PublicHolidayUrl";
	public static final String BUS_PARAM_RUA_RATIO = "RuaRatio";
	public static final String BUS_PARAM_CALENDAR_EVENT_COLOR = "CalendarEventColor";
	public static final String BUS_PARAM_ASSIGNMENT_EVENT_COLOR = "AssignmentEventColor";
	public static final String BUS_PARAM_FREEZE_SURVEY_MONTH = "FreezeSurveyMonth";
	public static final String BUS_PARAM_MOBILE_SYNC_PERIOD = "MobileSynchronizationPeriod";
	public static final String BUS_PARAM_LAST_MODIFY = "lastModify";
	public static final String BUS_PARAM_DELINK_PERIOD = "Delink Period";
	
	public static final String PE_PARAM_EXCLUDE_PE_CHECK_MONTH = "excludePeCheckMonth";
	public static final String PE_PARAM_SELECT_PE_CHECK_PERCENTAGE = "selectPeCheckPercentage";
	public static final String PE_PARAM_INCLUDE_NEW_RECRUITMENT = "includeNewRecruitment";
	public static final String PE_PARAM_INCLUDE_RUA_CASE = "includeRUACase";
	

	public static final String ITINERARY_PARAM_NO_OF_ASSIGNMENT_DEVIATION = "itineraryNoofAssignmentDeviation";
	public static final String ITINERARY_PARAM_NO_OF_ASSIGNMENT_DEVIATION_PLUS = "itineraryNoofAssignmentDeviationPlus";
	public static final String ITINERARY_PARAM_NO_OF_ASSIGNMENT_DEVIATION_MINUS = "itineraryNoofAssignmentDeviationMinus";
	public static final String ITINERARY_PARAM_SEQUENCE_DEVIATION = "itinerarySequenceDeviation";
	public static final String ITINERARY_PARAM_SEQUENCE_PERCENTS = "itinerarySequencePercents";
	public static final String ITINERARY_PARAM_TPU_SEQUENCE_DEVIATION = "itineraryTPUSequenceDeviation";
	public static final String ITINERARY_PARAM_TPU_SEQUENCE_DEVIATION_TIMES = "itineraryTPUSequenceDeviationTimes";
	
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_1 = "onSpotValidationMessage1";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_2 = "onSpotValidationMessage2";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_3 = "onSpotValidationMessage3";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_4 = "onSpotValidationMessage4";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_5 = "onSpotValidationMessage5";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_6 = "onSpotValidationMessage6";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_7 = "onSpotValidationMessage7";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_8 = "onSpotValidationMessage8";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_9 = "onSpotValidationMessage9";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_10 = "onSpotValidationMessage10";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_11 = "onSpotValidationMessage11";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_12 = "onSpotValidationMessage12";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_13 = "onSpotValidationMessage13";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_14 = "onSpotValidationMessage14";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_15 = "onSpotValidationMessage15";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_16 = "onSpotValidationMessage16";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_17 = "onSpotValidationMessage17";
	public static final String 	ON_SPOT_VALIDATION_MESSAGE_18 = "onSpotValidationMessage18";

	
	// end of system configuration name
	
	
	// Authority Level
	/**
	 * Section Head Authority Level: 1
	 */
	public static final int AUTHORITY_LEVEL_SECTION_HEAD = 1;
	/**
	 * Field Team Head Authority Level: 2
	 */
	public static final int AUTHORITY_LEVEL_FIELD_TEAM_HEAD = 2;
	/**
	 * Field Supervisor Authority Level: 4
	 */
	public static final int AUTHORITY_LEVEL_FIELD_SUPERVISOR = 4;
	/**
	 * Allocation Coordinator Authority Level: 8
	 */
	public static final int AUTHORITY_LEVEL_ALLOCATION_COORDINATOR = 8;
	/**
	 * Field Officers Authority Level: 16
	 */
	public static final int AUTHORITY_LEVEL_FIELD_OFFICERS = 16;
	/**
	 * Indoor Allocation Coordinator Authority Level: 32
	 */
	public static final int AUTHORITY_LEVEL_INDOOR_ALLOCATION_COORDINATOR = 32;
	/**
	 * Indoor Review Authority Level: 64
	 */
	public static final int AUTHORITY_LEVEL_INDOOR_REVIEW = 64;
	/**
	 * Indoor Data Conversion Authority Level: 128
	 */
	public static final int AUTHORITY_LEVEL_INDOOR_DATA_CONVERSION = 128;
	/**
	 * Business Data Administrator Authority Level: 256
	 */
	public static final int AUTHORITY_LEVEL_BUSINESS_DATA_ADMINISTRATOR = 256;
	/**
	 * System Administrator Authority Level: 512
	 */
	public static final int AUTHORITY_LEVEL_SYSTEM_ADMINISTRATOR = 512;
	/**
	 * Indoor Supervisor Authority Level: 1024
	 */
	public static final int AUTHORITY_LEVEL_INDOOR_SUPERVISOR = 1024;
	/**
	 * Business Data Viewer Authority Level: 2048
	 */
	public static final int AUTHORITY_LEVEL_BUSINESS_DATA_VIEWER = 2048;
	// end of authority Level
	
	
	/**
	 * Success message
	 */
	public static final String SUCCESS_MESSAGE = "SUCCESS_MESSAGE";
	/**
	 * Fail message
	 */
	public static final String FAIL_MESSAGE = "FAIL_MESSAGE";
		
	public static final String ASSIGNMENT_TYPE_1 = "Specified Collection Date & Officer";
	
	public static final String ASSIGNMENT_TYPE_2 = "Start/End Date & Specified Officer";
	
	public static final String ASSIGNMENT_TYPE_3 = "Start/End Date & Unspecified Officer";
	
	
	public static final String SURVEY_1 = "MRPS"; // originally = CPI 
	
	public static final String SURVEY_2 = "GHS";
	
	public static final String SURVEY_3 = "BMWPS";
	
	public static final String SURVEY_4 = "Others";
	
	public static final int STAFF_CALENDAR_ACTIVITY_TYPE_OT = 1;
	public static final int STAFF_CALENDAR_ACTIVITY_TYPE_TIMEOFF = 2;
	public static final int STAFF_CALENDAR_ACTIVITY_TYPE_OTHERS = 3;
	
	
	public static final String TASK_STATUS_PENDING = "Pending";
	public static final String TASK_STATUS_IN_PROGRESS = "In Progress";
	public static final String TASK_STATUS_FINISHED = "Finished";
	public static final String TASK_STATUS_FAILED = "Failed";
	
	public static final String TASK_TYPE_IMPORT = "Import";
	public static final String TASK_TYPE_EXPORT = "Export";
	
	
	public static final String REPORT_DATE_TIME_FORMAT = "yyyy-MM-dd HH:mm:ss";
	public static final String DATE_TIME_FORMAT = "dd-MM-yyyy HH:mm:ss";
	public static final String DATE_FORMAT = "dd-MM-yyyy";
	public static final String REPORT_DATE_FORMAT = "dd/MM/yyyy";
	public static final String TIME_FORMAT = "HH:mm";
	public static final String MONTH_FORMAT = "MM-yyyy";
	public static final String SHORT_MONTH_FORMAT = "MMMM yyyy";
	public static final String REPORT_SHORT_MONTH_FORMAT = "yyyyMM";
	public static final String REPORT_REFERENCE_DATE_FORMAT = "yyyy-MM-dd";
	
	
	public static final String REASON_TYPE_1 = "Price";
	
	public static final String REASON_TYPE_2 = "Discount";

	
	public static final String CPI_QOUTATION_TYPE_1 = "Market";
	
	public static final String CPI_QOUTATION_TYPE_2 = "Supermarket";
	
	public static final String CPI_QOUTATION_TYPE_3 = "Batch";
	
	public static final String CPI_QOUTATION_TYPE_4 = "Others";
	
	public static final String QUOTATIONRECORD_QUOTATIONSTATE_NORMAL = "Normal";
	public static final String QUOTATIONRECORD_QUOTATIONSTATE_REVISIT = "Revisit";
	public static final String QUOTATIONRECORD_QUOTATIONSTATE_VERIFY = "Verify";
	
	public static final String QUOTATIONRECORD_STATUS_BLANK = "Blank";
	public static final String QUOTATIONRECORD_STATUS_DRAFT = "Draft";
	public static final String QUOTATIONRECORD_STATUS_SUBMITTED = "Submitted";
	public static final String QUOTATIONRECORD_STATUS_APPROVED = "Approved";
	public static final String QUOTATIONRECORD_STATUS_REJECTED = "Rejected";

	public static final String ASSIGNMENTREALLOCATION_STATUS_SUBMITTED = "Submitted";
	public static final String ASSIGNMENTREALLOCATION_STATUS_REJECTED = "Rejected";
	public static final String ASSIGNMENTREALLOCATION_STATUS_APPROVED = "Approved";
	public static final String ASSIGNMENTREALLOCATION_STATUS_RECOMMENDED = "Recommended";

	public static final String SUPERVISORYVISITFORM_STATUS_SUBMITTED = "Submitted";
	public static final String SUPERVISORYVISITFORM_STATUS_REJECTED = "Rejected";
	public static final String SUPERVISORYVISITFORM_STATUS_APPROVED = "Approved";
	public static final String SUPERVISORYVISITFORM_STATUS_DRAFT = "Draft";

	public static final String SPOTCHECKFORM_STATUS_SUBMITTED = "Submitted";
	public static final String SPOTCHECKFORM_STATUS_REJECTED = "Rejected";
	public static final String SPOTCHECKFORM_STATUS_APPROVED = "Approved";
	public static final String SPOTCHECKFORM_STATUS_DRAFT = "Draft";

	public static final String TIMELOG_STATUS_DRAFT = "Draft";
	public static final String TIMELOG_STATUS_APPROVED = "Approved";
	public static final String TIMELOG_STATUS_REJECTED = "Rejected";
	public static final String TIMELOG_STATUS_SUBMITTED = "Submitted";
	public static final String TIMELOG_STATUS_VOILATED = "Voilated";
	
	public static final String FIELDWORKTIMELOG_ACITIVITY_1 = "FI";
	public static final String FIELDWORKTIMELOG_ACITIVITY_2 = "TR";
	public static final String FIELDWORKTIMELOG_ACITIVITY_3 = "SD";
	public static final String FIELDWORKTIMELOG_ACITIVITY_4 = "LD";
	public static final String FIELDWORKTIMELOG_ACITIVITY_5 = "SA";
	public static final String FIELDWORKTIMELOG_ACITIVITY_6 = "OD";
	public static final String FIELDWORKTIMELOG_ACITIVITY_7 = "OT";
	public static final String FIELDWORKTIMELOG_ACITIVITY_8 = "/";

	public static final String FIELDWORKTIMELOG_TRANSPORT_1 = "B";
	public static final String FIELDWORKTIMELOG_TRANSPORT_2 = "TB";
	public static final String FIELDWORKTIMELOG_TRANSPORT_3 = "LB";
	public static final String FIELDWORKTIMELOG_TRANSPORT_4 = "MLB";
	public static final String FIELDWORKTIMELOG_TRANSPORT_5 = "TX";
	public static final String FIELDWORKTIMELOG_TRANSPORT_6 = "LRT";
	public static final String FIELDWORKTIMELOG_TRANSPORT_7 = "MTR";
	public static final String FIELDWORKTIMELOG_TRANSPORT_8 = "AR";
	public static final String FIELDWORKTIMELOG_TRANSPORT_9 = "TRM";
	public static final String FIELDWORKTIMELOG_TRANSPORT_10 = "PRM";
	public static final String FIELDWORKTIMELOG_TRANSPORT_11 = "F";
	public static final String FIELDWORKTIMELOG_TRANSPORT_12 = "OF";
	public static final String FIELDWORKTIMELOG_TRANSPORT_13 = "O";
	
	public static final String ASSIGNMENTTRANSFERINOUT_STATE_MAINTENANCE = "Maintenance";
	public static final String ASSIGNMENTTRANSFERINOUT_STATE_RECOMMENDATION = "Recommendation";
	public static final String ASSIGNMENTTRANSFERINOUT_STATE_APPROVAL = "Approval";
	public static final String ASSIGNMENTTRANSFERINOUT_STATE_REJECT_RECOMMENDATION = "Reject Recommendation";
	public static final String ASSIGNMENTTRANSFERINOUT_STATE_REJECT_APPROVAL = "Reject Approval";
	
	public static final String EMPTY = "";
	public static final String EMPTY_STRING_FORMAT = "-";
	public static final String EMPTY_STRING_TIME_FORMAT = "                -                  (      Hr      Min)";
	
	public static final String USER_STATUS_ACTIVE = "Active";
	public static final String USER_STATUS_INACTIVE = "Inactive";
	
	public static final String[] FIRM_STATUS = {
			"",
			"Enumeration (EN)",
			"Closed (CL)",
			"Move (MV)",
			"Not Suitable (NS)",
			"Refusal (NR)",
			"Wrong Outlet (WO)",
			"Door Lock (DL)",
			"Non-contact (NC)",
			"In Progress (IP)",
			"Duplication (DU)",
			};

	public static final String[] COLLECTION_METHOD = {
			"",
			"Field Visit",
			"Telephone",
			"Fax",
			"Others",
			};
	
	public static final String[] QUOTATIONRECORD_AVALIBILITY = {
			"",
			"Available",
			"IP",
			"有價無貨",
			"無價無貨",
			"Not Suitable",
			"回倉",
			"無團",
			"未返",
			"New"
	};

	//For 9012: ["無價無貨" should be "缺貨"]
	public static final String[] QUOTATIONRECORD_AVALIBILITY1 = {
			"",
			"Available",
			"IP",
			"有價無貨",
			"缺貨",
			"Not Suitable",
			"回倉",
			"無團",
			"未返",
			"New"
	};
	
	public static final String getQuotationHistoryByAssignmentIdsSQL = 
			"( " + 
			"	SELECT * FROM " + 
			"	( " + 
			" " + 
			"		SELECT " +
			"           r.HistoryDate,  " +
			"			qr.QuotationId, " + 
			"			qr.ReferenceDate, " + 
			"			MIN(qr.QuotationRecordId) AS QuotationRecordId , " + 
			"			ROW_NUMBER() OVER (  PARTITION BY qr.QuotationId,  r.HistoryDate  ORDER BY r.HistoryDate, qr.QuotationId, qr.ReferenceDate DESC  ) AS [Order] " + 
			"		FROM QuotationRecord qr, " + 
			"		( " + 
			"			SELECT r.QuotationId , r.HistoryDate , r.assignmentId " + 
			"			FROM   QuotationRecord r, assignment a " + 
			"			WHERE r.assignmentId = a.assignmentId " + 
			"				and a.assignmentId in (:assignmentIds) " + 
			"		) r " + 
			"		WHERE   qr.isBackNo = 0 " + 
			"				AND qr.ReferenceDate  < r.HistoryDate " + 
			"				AND qr.QuotationId = r.QuotationId " + 
			"		GROUP BY  r.HistoryDate, qr.QuotationId  , qr.ReferenceDate " + 						
			"	) qr4  WHERE  [Order]  < 9 " + 
			"	UNION ALL " + 
			"	SELECT * FROM " + 
			"	( " + 
			"		SELECT " + 
			"           r.HistoryDate,  " +
			"			qr.QuotationId, " + 
			"			qr.ReferenceDate, " + 
			"			MIN(qr.QuotationRecordId) AS QuotationRecordId , " + 
			"			ROW_NUMBER() OVER (  PARTITION BY qr.QuotationId,  r.HistoryDate  ORDER BY r.HistoryDate, qr.QuotationId, qr.ReferenceDate DESC  ) AS [Order] " + 
			"		FROM QuotationRecord qr, " + 
			"		( " + 
			"			SELECT r.QuotationId , r.HistoryDate , r.assignmentId, " + 
			"                  DATEADD(day, 1, EOMONTH(r.HistoryDate, -13)) as lastYearHistoryStartDate, " + 
			"                  EOMONTH(r.HistoryDate, -12) as lastYearHistoryEndDate " +
			"			FROM   QuotationRecord r, assignment a " + 
			"			WHERE r.assignmentId = a.assignmentId " + 
			"				and a.assignmentId in (:assignmentIds) " + 
			"		) r " + 
			"		WHERE   qr.isBackNo = 0 " + 
			// "				AND qr.ReferenceDate  <=  DATEADD(month, -12,r.HistoryDate) " +
            "               AND qr.ReferenceDate between lastYearHistoryStartDate AND lastYearHistoryEndDate " +
			"				AND qr.ReferenceDate  < r.HistoryDate " + 
			"				AND  qr.QuotationId = r.QuotationId " + 
			"		GROUP BY  r.HistoryDate, qr.QuotationId  , qr.ReferenceDate " + 
			"	) qr1 WHERE  [Order]  = 1 " + 
			")  a  ";

	public static final String getQuotationHistoryByQuotationIdsHistoryDatesSQL = 
				"( " + 
				"	SELECT * FROM " + 
				"	( " + 
				" " + 
				"		SELECT " + 
				"			qr.QuotationId, " + 
				"			qr.ReferenceDate, " + 
				"			MIN(qr.QuotationRecordId) AS QuotationRecordId , " + 
				"			ROW_NUMBER() OVER (  PARTITION BY qr.QuotationId  ORDER BY  qr.ReferenceDate DESC  ) AS [Order] " + 
				"		FROM QuotationRecord qr, " + 
//				"		( " + 
//				"			SELECT   " + 
//				//"				SUBSTRING(Item,0,charindex('_',Item))as QuotationId " + 
//				"               CONVERT(INT,SUBSTRING(Item,0,charindex('_',Item))) as QuotationId"+
//				"				,CONVERT(datetime,SUBSTRING(Item,charindex('_',Item)+1,len(Item)+1) , 105) as HistoryDate " + 
//				"				,Item  " + 
//				"			FROM  Split2(:quotationIdsHistoryDates, ',')  " + 
//				"		) r " + 
				"       (" + 		 
				"		SELECT  " + 
				"		convert(int ,Item ) as QuotationId " +  
				"		,convert(date, getdate(), 106)as HistoryDate" + 
				"		,Item " + 
				"		FROM " + 
				"		 Split2(:quotationIdsHistoryDates, ',')" + 
				"		) r" + 
				
				"		WHERE   qr.isBackNo = 0 " + 
				"				AND qr.ReferenceDate  < r.HistoryDate " + 
				"				AND qr.QuotationId = r.QuotationId " + 
				"		GROUP BY  qr.QuotationId  , qr.ReferenceDate " + 						
				"	) qr4  WHERE  [Order]  < 9 " + 
				"	UNION ALL " + 
				"	SELECT * FROM " + 
				"	( " + 
				"		SELECT " + 
				"			qr.QuotationId, " + 
				"			qr.ReferenceDate, " + 
				"			MIN(qr.QuotationRecordId) AS QuotationRecordId , " + 
				"			ROW_NUMBER() OVER (  PARTITION BY qr.QuotationId  ORDER BY  qr.ReferenceDate DESC  ) AS [Order] " + 
				"		FROM QuotationRecord qr, " + 
//				"		( " + 
//				"			SELECT   " + 
//				//"				SUBSTRING(Item,0,charindex('_',Item))as QuotationId " + 
//				"               CONVERT(INT,SUBSTRING(Item,0,charindex('_',Item))) as QuotationId"+
//				"				,CONVERT(datetime,SUBSTRING(Item,charindex('_',Item)+1,len(Item)+1) , 105) as HistoryDate " + 
//				"				,Item  " + 
//				"			FROM  Split2(:quotationIdsHistoryDates, ',')  " + 
//				"		) r " + 
				"       (" + 		 
				"		SELECT  " + 
				"		convert(int ,Item ) as QuotationId " +  
				"		,convert(date, getdate(), 106)as HistoryDate" + 
				"		,Item " +
				"       ,DATEADD(day, 1, EOMONTH(convert(date, getdate(), 106), -13)) as lastYearHistoryStartDate" + 
				"       ,EOMONTH(convert(date, getdate(), 106), -12) as lastYearHistoryEndDate" +
				"		FROM " + 
				"		 Split2(:quotationIdsHistoryDates, ',')" + 
				"		) r" + 
				
				"		WHERE   qr.isBackNo = 0 " + 
				// "				AND qr.ReferenceDate  <=  DATEADD(month, -12,r.HistoryDate) " + 				
                "               AND qr.ReferenceDate between lastYearHistoryStartDate AND lastYearHistoryEndDate " +
				"				AND qr.ReferenceDate  < r.HistoryDate " + 
				"				AND qr.QuotationId = r.QuotationId " + 
				"		GROUP BY  qr.QuotationId  , qr.ReferenceDate " + 
				"	) qr1 WHERE  [Order]  = 1 " + 
				")  a  ";	
}
